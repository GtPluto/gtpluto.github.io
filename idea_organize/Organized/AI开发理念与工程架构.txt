# AI 开发理念与工程架构 (AI Development Philosophy & Engineering Architecture)

## 核心理念 (Core Philosophy)
在现代 AI 开发中，AI 更擅长创造的是边界定义清晰、内容明确的东西，因此在开发的过程中，应当将能独立出来的功能尽可能独立出来成为单独的开发部件。

对于AI来说，其精简地实现人类想要的内容便是他们所需要做的。那么在AI时代，人类的差异在哪里？便是对于复杂系统的整体认知，提出详细的、更加完善的需求。比如，提出一个网页需求的人，可能并不知道去构建一个大型网站所需要的安全相关的内容。而这则是程序员之间的差距：知识的储备容量。

AI 不擅长处理那些在快速变化的信息（知识）。例如 Bazel 版本问题。

## 架构视野与组织 (Architecture Overview & Organization)
对于大规模应用，应当存在一个从上而下的不同视野的对于执行项目的看法（例如高层是对于项目的overview，而越是底层则越接近具体功能和执行细节）；而使用接力的小服务（以及对应的软件框架）及带版本则可以使得 AI 在开发组件更流程。

良好的文档组织结构： 对于任何一个工作，都可以自上而下获得所有应当获得的上下文，作为这个任务的全集，允许任何一个合格的工程师（或AI）使用这部分信息就可以完成任务。

一个组应当有本组所需要的所有知识，应当尽可能清晰地罗列出来。参与本组项目的人应当学习并通过这些知识相关的测试。所有知识内容都必须是AI 可解析的，AI管理的。临时项目也可以获取所需要的所有知识内容。

软件工程需要考虑到的: 如果当前做的事情不是一次性的，或者是未来需要持续接触的，那么就需要考虑到：
1. 未来的维护成本
2. 未来更新所需要的成本
3. 未来的使用成本

## 服务化与接口设计 (Services & Interface Design)
想法是将服务变成最小可部署模块（一小时就可以上线的最小化模块），然后让各个服务之间进行互相调用。用 RPC 进行互相调用？

服务器即是接口 idea
使用 Semantic Versioning 来管理版本，上线新接口不需要关闭老接口。
在开发阶段是这样，在实际上线阶段时则会将这些接口整合。开发一个框架允许实现这种自动整合功能。
这个的另外好处是，可以创建自动测试，针对接口进行单独测试。这样在某个接口版本发生变动之后，可以迅速知道这个接口版本的升级是否 break 了其他的接口。

更棒的是，这个框架非常兼容现代的 AI 设施。因为 AI 可能需要快速迭代代码，而由 AI 迭代的代码则可能会被损坏。这个框架根据接口来做版本管理，则可以很好地找到损坏的代码版本。

## 版本管理与持续集成 (Versioning & CI)
将每一个接口单独放在一片区域内，用类似 Bazel 的方式来进行管理。其接口向外暴露，且使用版本管理。测试也使用版本管理，例如加上 annotation 说这个测试是针对什么版本是有效的。使用其他接口的时候，应当去看对应版本接口的文档，而非对应版本的测试内容。在 release 代码库的时候，则是有一个类似 Copybara 的工具，仅仅去获得对应版本所使用的测试内容。

一个接口的版本升级附带的链式升级：如果为了使用最新版本的某一个接口（特别是 patch version），而导致附带的链上所有版本都需要升级，那么这会是一个版本管理的灾难，因为这会产生过多的版本号。对于一个接口的 patch 版本升级，如果其依赖链上的项目的所有测试都通过，那么应当认为这个 patch 版本升级是无感的，因此应当自动升级版本（或者采用第四位版号？第四位版号仅仅自动生成，改动的部分仅仅是依赖项的 patch 版本号）。如果一个升级隔着依赖项导致另外的项目出现异常，那么其意味着中间项目的测试并没有覆盖到位，应当在中间项目的测试覆盖之后，升级一个 patch 版本。

接口的 Meta 信息。诸如此接口被什么项目依赖（依赖信息的双向化）用于判断是否需要继续维护此接口。此接口被什么 Snapshot 采用。

对外部依赖项的管理：按照 Bzlmod 的管理模式。

内部版本的冲突：不允许。采用 Snapshot 模式，也就是任何一个稳定态，全局的任意一个接口都只有一个版本。

版本升级例子：
1. 升级 patch version / minor version：在依赖图中寻找所有依赖此 interface 的项目，然后运行其测试。如果全员测试都通过，那么启动一个升级锁（防止同时版本升级冲突），然后将所有依赖项的第四位版本号升级1。如果测试没有通过：定位问题（意味着改变了接口的行为），升级失败。注意这里的 minor version 意味着接口做了向下兼容的功能性新增，因此理论上升级版本不会引起项目异常。
2. major version 不主动做升级。

## 工具应用 (Tools Idea)
一个潜在的 AI 应用：文档中带版本的部分的自动编译 + 测试，自动更新文档版本号和验证正确性。文档中的版本号可能过时。

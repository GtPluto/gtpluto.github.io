---
import { type CollectionEntry, getCollection } from 'astro:content';
import BaseLayout from '../../../layouts/BaseLayout.astro';
import { languages } from '../../../i18n/ui';

export async function getStaticPaths() {
	const posts = await getCollection('about');
	const paths = [];
	
	// Filter for non-English posts
	const nonEnPosts = posts.filter(post => !post.slug.startsWith('en/'));

	for (const post of nonEnPosts) {
		const [lang, ...slugParts] = post.slug.split('/');
		if (lang in languages && lang !== 'en') {
			paths.push({
				params: { lang, slug: slugParts.join('/') },
				props: post,
			});
		}
	}
	return paths;
}
type Props = CollectionEntry<'about'>;

const post = Astro.props;
const { Content } = await post.render();
---

<BaseLayout title={post.data.title} description={post.data.description}>
	<article class="about-article">
		<header>
			<h1>{post.data.title}</h1>
			<p class="description">{post.data.description}</p>
		</header>
		<div class="content">
			<Content />
		</div>
		<div class="back">
			<a href={`/${Astro.params.lang}/about`}>&larr; 返回关于我</a>
		</div>
	</article>
</BaseLayout>

<style>
	.about-article {
		max-width: 720px;
		margin: 0 auto;
	}

	header {
		margin-bottom: 3rem;
		text-align: center;
	}

	h1 {
		font-size: 2.5rem;
		margin-bottom: 1rem;
	}

	.description {
		font-size: 1.2rem;
		opacity: 0.8;
	}

	.content {
		line-height: 1.8;
		font-size: 1.1rem;
		margin-bottom: 3rem;
	}

	.content :global(h2) { margin-top: 2rem; }
	.content :global(p) { margin-bottom: 1.5rem; }

	.back {
		border-top: 1px solid var(--color-border);
		padding-top: 2rem;
	}
</style>
